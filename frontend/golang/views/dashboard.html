<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Utilisateur - Dashboard</title>
    <script src="/static/js/dashboard.js" defer></script>
    <script src="/static/js/QuestionEnGroupe.js" defer></script>
    <script src="/static/js/quizActions.js" defer></script>
    

    <style>
        #menu { margin-bottom: 20px; }
        .section { display: none; }
        .topbar { display: flex; justify-content: space-between; align-items: center; }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="topbar">
        <h1 id="welcome-message">Bienvenue, <span id="user-name"></span></h1>
        <a href="/logout">ğŸšª Se dÃ©connecter</a>
    </div>

    <!-- ğŸ” Token JWT injectÃ© dynamiquement via Go -->
    <input type="hidden" id="token" value="{{.Token}}">

    <div id="menu">
        <button onclick="showSection('badges')">ğŸ–ï¸ Badges</button>
        <button onclick="showSection('add-question')">â• Ajouter Question</button>
        <button onclick="showSection('add-quiz')">ğŸ“‹ Ajouter Questionnaire</button>
        <button onclick="showSection('create-session')">ğŸ•’ CrÃ©er Session</button>
        <button onclick="showSection('promotion-tools')" id="btn-promote" style="display:none;">âš™ï¸ Promotion / RÃ©trogradation</button>
    </div>

    <div id="content">

        <div id="badges" class="section">
            <h2>Attribution de Badges</h2>
            <p>FonctionnalitÃ© Ã  venir...</p>
        </div>

        <div id="add-question" class="section">
            <h2>Ajouter une Question</h2>
            <form id="add-question-form">
                <label for="quiz-select">SÃ©lectionnez un questionnaire :</label>
                <select id="quiz-select" name="quiz_id" required></select>
        
                <label>ThÃ¨me : <input type="text" name="theme" required></label><br>
                <label>DifficultÃ© :
                    <select name="difficulty" required>
                        <option value="facile">Facile</option>
                        <option value="moyen">Moyen</option>
                        <option value="difficile">Difficile</option>
                    </select>
                </label><br><br>
        
                <label>IntitulÃ© : <input type="text" name="question_text" required></label><br><br>
                <label>RÃ©ponse A : <input type="text" name="answerA" required></label><br>
                <label>RÃ©ponse B : <input type="text" name="answerB" required></label><br>
                <label>RÃ©ponse C : <input type="text" name="answerC" required></label><br>
                <label>RÃ©ponse D : <input type="text" name="answerD" required></label><br><br>
        
                <label>Bonne rÃ©ponse :
                    <select name="correct_answer" required>
                        <option value="A">RÃ©ponse A</option>
                        <option value="B">RÃ©ponse B</option>
                        <option value="C">RÃ©ponse C</option>
                        <option value="D">RÃ©ponse D</option>
                    </select>
                </label><br><br>
        
                <button type="submit">âœ… Ajouter la question</button>
            </form>

                <!-- Formulaire JSON -->
            <h2>ğŸ“¥ Ajouter plusieurs questions (JSON)</h3>

            <form id="bulk-question-form">
                <label for="quiz-id-bulk">ğŸ“‹ SÃ©lectionnez un questionnaire :</label>
                <select id="quiz-id-bulk" name="quiz_id" required></select><br><br>

                <label for="json-file">ğŸ“„ Choisissez un fichier JSON :</label>
                <input type="file" id="json-file" accept="application/json" required><br><br>

                <button type="submit">ğŸš€ Envoyer les questions</button>
            </form>
        </div>

        <div id="add-quiz" class="section">
            <h2>Ajouter un Questionnaire</h2>
            <form id="create-quiz-form">
                <label>Nom du questionnaire : <input type="text" name="title" required></label><br><br>
                <label>ThÃ¨me : <input type="text" name="theme" required></label><br><br>
                <label>DifficultÃ© :
                    <select name="difficulty" required>
                        <option value="facile">Facile</option>
                        <option value="moyen">Moyen</option>
                        <option value="difficile">Difficile</option>
                    </select>
                </label><br><br>
                <button type="submit">ğŸ“‹ Ajouter le questionnaire</button>
            </form>
        
            <h3>Mes Questionnaires</h3>
            <table id="quiz-table">
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>ThÃ¨me</th>
                        <th>DifficultÃ©</th>
                        <th>Nombre de Questions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- JS remplit ce tableau dynamiquement -->
                </tbody>
            </table>
        
            <!-- DÃ©tails des questions du quiz sÃ©lectionnÃ© -->
            <div id="quiz-details" style="margin-top: 30px; display: none;">
                <h4>ğŸ“š Questions du Questionnaire : <span id="selected-quiz-title"></span></h4>
                <ul id="question-list">
                    <!-- Questions seront injectÃ©es ici par JS -->
                </ul>
            </div>
        </div>
        

        <div id="create-session" class="section">
            <h2>CrÃ©er une Session de Jeu</h2>
        
            <form id="create-session-form">
                <label for="session-quiz-select">ğŸ“‹ Choisir un questionnaire :</label>
                <select id="session-quiz-select" name="quiz_id" required></select><br><br>
        
                <label for="duration">â± DurÃ©e (en minutes) :</label>
                <input type="number" id="duration" name="duration_minutes" min="1" required>
                <input type="hidden" id="host_id" value="{{.UserID}}">
        
                <button type="submit">ğŸ® Lancer la session</button>
            </form>
        
            <div id="active-sessions" style="margin-top: 40px;">
                <h2>ğŸ“Š Sessions en cours</h2>
                <table id="session-table">
                    <thead>
                        <tr>
                          <th>Quiz</th>
                          <th>Code</th>
                          <th>DurÃ©e (min)</th>
                          <th>DÃ©marrÃ©e Ã </th>
                          <th>Temps restant</th>
                          <th>Participants</th>
                        </tr>
                      </thead>                      
                    <tbody></tbody>
                </table>
            </div>
        </div>
        

        <div id="promotion-tools" class="section">
            <h2>Gestion des Utilisateurs</h2>

            <form id="promote-form" style="margin-bottom: 30px;">
                <fieldset>
                    <legend>âš¡ Promouvoir un Utilisateur</legend>
                    <label>Email :
                        <input type="email" name="email" required>
                    </label><br><br>
                    <button type="submit">âš¡ Promouvoir</button>
                </fieldset>
            </form>
            <div id="promote-message" class="status-msg" style="margin-bottom: 20px; font-weight: bold;"></div>
            
            <form id="demote-form">
                <fieldset>
                    <legend>â¬‡ï¸ RÃ©trograder un Utilisateur</legend>
                    <label>Email :
                        <input type="email" name="email" required>
                    </label><br><br>
                    <button type="submit">â¬‡ï¸ RÃ©trograder</button>
                </fieldset>
            </form>
            <div id="demote-message" class="status-msg" style="margin-top: 10px; font-weight: bold;"></div>
            
        </div>
    </div>
</body>
</html>
