<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Utilisateur - Dashboard</title>
    <script src="/static/js/dashboard.js" defer></script>
    <script src="/static/js/quizActions.js" defer></script>
    <style>
        #menu { margin-bottom: 20px; }
        .section { display: none; }
        .topbar { display: flex; justify-content: space-between; align-items: center; }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="topbar">
        <h1>Bienvenue, Super Utilisateur</h1>
        <a href="/logout">üö™ Se d√©connecter</a>
    </div>

    <!-- üîê Token JWT inject√© dynamiquement via Go -->
    <input type="hidden" id="token" value="{{.Token}}">

    <div id="menu">
        <button onclick="showSection('badges')">üéñÔ∏è Badges</button>
        <button onclick="showSection('add-question')">‚ûï Ajouter Question</button>
        <button onclick="showSection('add-quiz')">üìã Ajouter Questionnaire</button>
        <button onclick="showSection('create-session')">üïí Cr√©er Session</button>
        <button onclick="showSection('promotion-tools')" id="btn-promote" style="display:none;">‚öôÔ∏è Promotion / R√©trogradation</button>
    </div>

    <div id="content">

        <div id="badges" class="section">
            <h2>Attribution de Badges</h2>
            <p>Fonctionnalit√© √† venir...</p>
        </div>

        <div id="add-question" class="section">
            <h2>Ajouter une Question</h2>
            <form id="add-question-form">
                <label for="quiz-select">S√©lectionnez un questionnaire :</label>
                <select id="quiz-select" name="quiz_id" required></select>
        
                <label>Th√®me : <input type="text" name="theme" required></label><br>
                <label>Difficult√© :
                    <select name="difficulty" required>
                        <option value="facile">Facile</option>
                        <option value="moyen">Moyen</option>
                        <option value="difficile">Difficile</option>
                    </select>
                </label><br><br>
        
                <label>Intitul√© : <input type="text" name="question_text" required></label><br><br>
                <label>R√©ponse A : <input type="text" name="answerA" required></label><br>
                <label>R√©ponse B : <input type="text" name="answerB" required></label><br>
                <label>R√©ponse C : <input type="text" name="answerC" required></label><br>
                <label>R√©ponse D : <input type="text" name="answerD" required></label><br><br>
        
                <label>Bonne r√©ponse :
                    <select name="correct_answer" required>
                        <option value="A">R√©ponse A</option>
                        <option value="B">R√©ponse B</option>
                        <option value="C">R√©ponse C</option>
                        <option value="D">R√©ponse D</option>
                    </select>
                </label><br><br>
        
                <button type="submit">‚úÖ Ajouter la question</button>
            </form>
        </div>
        
        

        <div id="add-quiz" class="section">
            <h2>Ajouter un Questionnaire</h2>
            <form id="create-quiz-form">
                <label>Nom du questionnaire : <input type="text" name="title" required></label><br><br>
                <label>Th√®me : <input type="text" name="theme" required></label><br><br>
                <label>Difficult√© :
                    <select name="difficulty" required>
                        <option value="facile">Facile</option>
                        <option value="moyen">Moyen</option>
                        <option value="difficile">Difficile</option>
                    </select>
                </label><br><br>
                <button type="submit">üìã Ajouter le questionnaire</button>
            </form>
        
            <h3>Mes Questionnaires</h3>
            <table id="quiz-table">
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Th√®me</th>
                        <th>Difficult√©</th>
                        <th>Nombre de Questions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- JS remplit ce tableau dynamiquement -->
                </tbody>
            </table>
        
            <!-- D√©tails des questions du quiz s√©lectionn√© -->
            <div id="quiz-details" style="margin-top: 30px; display: none;">
                <h4>üìö Questions du Questionnaire : <span id="selected-quiz-title"></span></h4>
                <ul id="question-list">
                    <!-- Questions seront inject√©es ici par JS -->
                </ul>
            </div>
        </div>
        

        <div id="create-session" class="section">
            <h2>Cr√©er une Session de Jeu</h2>
        
            <form id="create-session-form">
                <label for="session-quiz-select">üìã Choisir un questionnaire :</label>
                <select id="session-quiz-select" name="quiz_id" required></select><br><br>
        
                <label for="duration">‚è± Dur√©e (en minutes) :</label>
                <input type="number" id="duration" name="duration_minutes" min="1" required>
                <input type="hidden" id="host_id" value="{{.UserID}}">
        
                <button type="submit">üéÆ Lancer la session</button>
            </form>
        
            <div id="active-sessions" style="margin-top: 40px;">
                <h2>üìä Sessions en cours</h2>
                <table id="session-table">
                    <thead>
                        <tr>
                          <th>Quiz</th>
                          <th>Code</th>
                          <th>Dur√©e (min)</th>
                          <th>D√©marr√©e √†</th>
                          <th>Temps restant</th>
                          <th>Participants</th>
                        </tr>
                      </thead>                      
                    <tbody></tbody>
                </table>
            </div>
        </div>
        

        <div id="promotion-tools" class="section">
            <h2>Gestion des Utilisateurs</h2>

            <form action="/promote-user" method="POST" style="margin-bottom: 30px;">
                <fieldset>
                    <legend>‚ö° Promouvoir un Utilisateur</legend>
                    <label>Email :
                        <input type="email" name="email" required>
                    </label><br><br>
                    <button type="submit">‚ö° Promouvoir</button>
                </fieldset>
            </form>

            <form action="/demote-user" method="POST">
                <fieldset>
                    <legend>‚¨áÔ∏è R√©trograder un Utilisateur</legend>
                    <label>Email :
                        <input type="email" name="email" required>
                    </label><br><br>
                    <button type="submit">‚¨áÔ∏è R√©trograder</button>
                </fieldset>
            </form>
        </div>
    </div>
</body>
</html>
